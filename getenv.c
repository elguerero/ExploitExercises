#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char* argv[]) {
    if (argc <= 2) {
        printf("usage: %s <variable name> <target program name>\n", argv[0]);
        return 1;
    }
    char* addr = getenv(argv[1]);
    if (addr == NULL) {
        printf("variable %s not defined\n", argv[1]);
        return 2;
    }
    addr += (strlen(argv[0]) - strlen(argv[2])) * 2;
    printf("%p\n", addr);
    return 0;
}


/* Wie der ProgrammNAME angepasst wird */
/* wichtig ist dass der ProgrammPFAD /root/Schreibtisch/ExploitExercises/ berücksichtigt wird,
   aber der Code Name indemfall stack7 nicht berücksichtigt wird.
   Deshalb zieht man vom Pfad den Namen ab Pfad-Name, da es im Stack allerdings doppelt vorkommt muss man mit 2 multiplizieren!
   Somit lautet die Formel: SHELLCODE Pfad = SHELLCODE Pfad + (PFAD - NAME)*2 */
//argv[0] => /root/Schreibtisch/ExploitExercises/stack7
//argv[1] => SHELLCODE
//argv[2] => stack7

// Mein Code

/*
#include <stdlib.h>
#include <stdio.h>
#include <string.h>


int main(int argc, const char *argv[])
{
  char *env_add;
  int length=0xFF;

  if(argc<3)
    printf("Not enough arguments\n");
  else{
      env_add = getenv(argv[1]);

      if(env_add != NULL)
      {
        env_add += (argv[0]-argv[2])*2;
        printf("Var: %s; Address: %p;\n", argv[1], env_add);
      }
      else printf("env var name invalid\n");
  }

  return 1;
}
*/
